module.exports=function(t){var o={};function e(r){if(o[r])return o[r].exports;var n=o[r]={i:r,l:!1,exports:{}};return t[r].call(n.exports,n,n.exports,e),n.l=!0,n.exports}return e.m=t,e.c=o,e.d=function(t,o,r){e.o(t,o)||Object.defineProperty(t,o,{enumerable:!0,get:r})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,o){if(1&o&&(t=e(t)),8&o)return t;if(4&o&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(e.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&o&&"string"!=typeof t)for(var n in t)e.d(r,n,function(o){return t[o]}.bind(null,n));return r},e.n=function(t){var o=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(o,"a",o),o},e.o=function(t,o){return Object.prototype.hasOwnProperty.call(t,o)},e.p="",e(e.s=20)}([function(t,o){t.exports=flarum.core.compat["forum/app"]},function(t,o){t.exports=flarum.core.compat["common/extend"]},function(t,o){t.exports=flarum.core.compat["forum/components/SignUpModal"]},,function(t,o){t.exports=flarum.core.compat["forum/components/IndexPage"]},function(t,o){t.exports=flarum.core.compat["common/helpers/listItems"]},,,function(t,o){t.exports=flarum.core.compat["forum/components/DiscussionPage"]},function(t,o){t.exports=flarum.core.compat["common/Component"]},function(t,o){t.exports=flarum.core.compat["common/components/Button"]},function(t,o){t.exports=flarum.core.compat["common/components/Badge"]},function(t,o){t.exports=flarum.core.compat["forum/components/CommentPost"]},function(t,o){t.exports=flarum.core.compat["forum/components/DiscussionComposer"]},function(t,o){t.exports=flarum.core.compat["forum/components/ReplyComposer"]},function(t,o){t.exports=flarum.core.compat["forum/utils/DiscussionControls"]},function(t,o){t.exports=flarum.core.compat["forum/components/ReplyPlaceholder"]},function(t,o){t.exports=flarum.core.compat["common/helpers/avatar"]},function(t,o){t.exports=flarum.core.compat["common/helpers/username"]},function(t,o){t.exports=flarum.core.compat["forum/components/ComposerPostPreview"]},function(t,o,e){"use strict";e.r(o),e.d(o,"filterPostMentions",(function(){return F}));var r=e(0),n=e.n(r),s=e(1),u=e(4),a=e.n(u),i=e(8),c=e.n(i);function p(t,o){return(p=Object.setPrototypeOf||function(t,o){return t.__proto__=o,t})(t,o)}var l=e(9),f=e.n(l),d=e(10),g=e.n(d),b=e(2),y=e.n(b),v=e(5),h=e.n(v),x=function(t){var o,e;function r(){return t.apply(this,arguments)||this}return e=t,(o=r).prototype=Object.create(e.prototype),o.prototype.constructor=o,p(o,e),r.prototype.view=function(){var t="";return t=n.a.forum.attribute("guestPostCount")&&n.a.forum.attribute("guestVoteCount")?n.a.translator.trans("guest-posting.forum.alert.create-account-posts-and-votes",{postCount:n.a.forum.attribute("guestPostCount"),voteCount:n.a.forum.attribute("guestVoteCount")}):n.a.forum.attribute("guestVoteCount")?n.a.translator.trans("guest-posting.forum.alert.create-account-votes-only",{count:n.a.forum.attribute("guestVoteCount")}):n.a.translator.trans("guest-posting.forum.alert.create-account",{count:n.a.forum.attribute("guestPostCount")}),m(".Alert.Alert-info",m(".container",[m("span.Alert-body",t),m("ul.Alert-controls",h()([g.a.component({className:"Button Button--link",onclick:function(){n.a.modal.show(y.a)}},n.a.translator.trans("guest-posting.forum.alert.signup"))]))]))},r}(f.a);function P(t){for(var o=arguments.length,e=new Array(o>1?o-1:0),r=1;r<o;r++)e[r-1]=arguments[r];var s=t.apply(void 0,e);if(!n.a.forum.attribute("guestPostCount")&&!n.a.forum.attribute("guestVoteCount"))return s;var u=x.component();return Array.isArray(s)?(s.unshift(u),s):m("div",[u,s])}var C=e(11),O=e.n(C),j=e(12),A=e.n(j),w=e(13),_=e.n(w),V=e(14),D=e.n(V),G=e(15),N=e.n(G),S=e(16),U=e.n(S),M=e(17),R=e.n(M),k=e(18),B=e.n(k),T=e(19),I=e.n(T);function F(t){var o=app.store.getById("posts",t.getAttribute("id"));if(o&&o.attribute("guest_username"))return t.setAttribute("discussionid",o.discussion().id()),t.setAttribute("number",o.number()),t.setAttribute("displayname",o.attribute("guest_username")),!0}n.a.initializers.add("guest-posting",(function(){Object(s.override)(a.a.prototype,"hero",P),Object(s.override)(c.a.prototype,"view",P),Object(s.override)(N.a,"replyAction",(function(t,o,e){var r=this;return!n.a.session.user&&this.canReply()?new Promise((function(t){return n.a.composer.composingReplyTo(r)&&!e||n.a.composer.load(D.a,{user:n.a.session.user,discussion:r}),n.a.composer.show(),o&&n.a.viewingDiscussion(r)&&!n.a.composer.isFullScreen()&&n.a.current.get("stream").goToNumber("reply"),t(n.a.composer)})):t(o,e)})),Object(s.override)(a.a.prototype,"newDiscussionAction",(function(t){return!n.a.session.user&&n.a.forum.attribute("canStartDiscussion")?new Promise((function(t){return n.a.composer.load(_.a,{user:n.a.session.user}),n.a.composer.show(),t(n.a.composer)})):t()})),Object(s.extend)(A.a.prototype,"headerItems",(function(t){var o=this.attrs.post.attribute("guest_username");o&&(t.has("user")&&t.remove("user"),t.add("guest-user",m(".PostUser",[m("h3",[m("span.Avatar.PostUser-avatar",o.charAt(0).toUpperCase()),m("span.username",o)]),m("ul.PostUser-badges badges",m("li",O.a.component({type:"guest",icon:"fas fa-user-secret",label:n.a.translator.trans("guest-posting.forum.badge.guest")})))]),100))})),Object(s.override)(U.a.prototype,"view",(function(t){if(n.a.composer.composingReplyTo(this.attrs.discussion))return m("article",{className:"Post CommentPost editing"},m("header",{className:"Post-header"},m("div",{className:"PostUser"},m("h3",null,R()(n.a.session.user,{className:"PostUser-avatar"}),B()(n.a.session.user)),n.a.session.user?m("ul",{className:"PostUser-badges badges"},h()(n.a.session.user.badges().toArray())):null)),m(I.a,{className:"Post-body",composer:n.a.composer,surround:this.anchorPreview.bind(this)}));for(var o=arguments.length,e=new Array(o>1?o-1:0),r=1;r<o;r++)e[r-1]=arguments[r];return t.apply(void 0,e)})),flarum.extensions["fof-polls"]&&flarum.extensions["fof-polls"].components&&flarum.extensions["fof-polls"].components.DiscussionPoll&&(Object(s.override)(flarum.extensions["fof-polls"].components.DiscussionPoll.prototype,"changeVote",(function(t){for(var o=arguments.length,e=new Array(o>1?o-1:0),r=1;r<o;r++)e[r-1]=arguments[r];!n.a.session.user&&this.poll.attribute("canGuestVote")?(n.a.session.user=!0,t.apply(void 0,e),n.a.session.user=null):t.apply(void 0,e)})),Object(s.extend)(flarum.extensions["fof-polls"].components.DiscussionPoll.prototype,"updateData",(function(){if(!n.a.session.user){var t=this.poll.attribute("guestVoteOption");this.myVotes=t?[n.a.store.createRecord("poll_votes",{id:"0",type:"poll_votes",relationships:{option:{data:{id:t,type:"poll_options"}}}})]:[]}}))),Object(s.extend)(y.a.prototype,"oninit",(function(){this.importGuestContent=!!n.a.forum.attribute("guestPostCount")})),Object(s.extend)(y.a.prototype,"fields",(function(t){var o=this;(n.a.forum.attribute("guestPostCount")||n.a.forum.attribute("guestVoteCount"))&&t.add("guest-posting",m(".Form-group",m("div",m("label.checkbox",[m("input",{type:"checkbox",checked:this.importGuestContent,onchange:function(){o.importGuestContent=!o.importGuestContent},disabled:this.loading}),n.a.forum.attribute("guestVoteCount")?n.a.translator.trans("guest-posting.forum.modal.import-votes",{postCount:n.a.forum.attribute("guestPostCount")||"0",voteCount:n.a.forum.attribute("guestVoteCount")}):n.a.translator.trans("guest-posting.forum.modal.import",{count:n.a.forum.attribute("guestPostCount")})]))))})),Object(s.extend)(y.a.prototype,"submitData",(function(t){this.importGuestContent&&(t.importGuestContent=this.importGuestContent)}))}))}]);
//# sourceMappingURL=forum.js.map